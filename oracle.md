

## 테이블 생성
    CREATE TABLE "BSB"."BS_BATCH_MEMBER" 
    ("USER_ID" VARCHAR2(30 BYTE) NOT NULL ENABLE, 
    "USER_NAME" VARCHAR2(30 BYTE), 
    "DEPARTMENT" VARCHAR2(30 BYTE), 
    "POSITION" VARCHAR2(30 BYTE), 
    "INSERT_DATE" DATE DEFAULT SYSDATE, 
         PRIMARY KEY ("USER_ID")
    USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
    STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
    PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
    TABLESPACE "USERS"  ENABLE
    ) SEGMENT CREATION IMMEDIATE 
    PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
    STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
    PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
    TABLESPACE "USERS" ;

  
  
## 병합쿼리
    MERGE INTO BS_MEMBER M USING 
    ( SELECT USER_ID, USER_NAME, DEPARTMENT, POSITION, INSERT_DATE
        FROM BS_BATCH_MEMBER BAT
        ) BAT
    ON (M.USER_ID = BAT.USER_ID) 
    WHEN MATCHED THEN
    UPDATE SET M.USER_NAME = BAT.USER_NAME
    WHEN NOT MATCHED THEN
    INSERT (USER_ID, USER_PWD, USER_NAME, FIRST_LOGIN_YN, LOGIN_FAIL_COUNT)
    VALUES(BAT.USER_ID,'AAAA',BAT.USER_NAME,'Y','0')
    ;